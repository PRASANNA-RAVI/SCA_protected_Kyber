#include "inttypes.h"
#include "ntt.h"
#include "params.h"

/* Precomputed constants for the forward NTT and inverse NTT.
 * Computed using Pari/GP as follows:
 *
brv=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240, \
     8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248, \
     4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244, \
     12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252, \
     2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242, \
     10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250, \
     6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246, \
     14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254, \
     1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241, \
     9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249, \
     5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245, \
     13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253, \
     3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243, \
     11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251, \
     7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247, \
     15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255];

q = 7681;
n = 256;
mont = Mod(2^18,q);

g=0; for(i=2,q-1,if(znorder(Mod(i,q)) == 2*n, g=Mod(i,q); break))

zetas = lift(vector(n, i, g^(brv[i])*mont))
omegas_inv_bitrev_montgomery = lift(vector(n/2, i, (g^2)^(-brv[2*(i-1)+1])*mont))
psis_inv_montgomery = lift(vector(n, i, g^(-(i-1))/n*mont))

*/

const uint16_t zetas[KYBER_N] = {
  990, 7427, 2634, 6819, 578, 3281, 2143, 1095, 484, 6362, 3336, 5382, 6086, 3823, 877, 5656,
  3583, 7010, 6414, 263, 1285, 291, 7143, 7338, 1581, 5134, 5184, 5932, 4042, 5775, 2468, 3,
  606, 729, 5383, 962, 3240, 7548, 5129, 7653, 5929, 4965, 2461, 641, 1584, 2666, 1142, 157,
  7407, 5222, 5602, 5142, 6140, 5485, 4931, 1559, 2085, 5284, 2056, 3538, 7269, 3535, 7190, 1957,
  3465, 6792, 1538, 4664, 2023, 7643, 3660, 7673, 1694, 6905, 3995, 3475, 5939, 1859, 6910, 4434,
  1019, 1492, 7087, 4761, 657, 4859, 5798, 2640, 1693, 2607, 2782, 5400, 6466, 1010, 957, 3851,
  2121, 6392, 7319, 3367, 3659, 3375, 6430, 7583, 1549, 5856, 4773, 6084, 5544, 1650, 3997, 4390,
  6722, 2915, 4245, 2635, 6128, 7676, 5737, 1616, 3457, 3132, 7196, 4702, 6239, 851, 2122, 3009,
  7613, 7295, 2007, 323, 5112, 3716, 2289, 6442, 6965, 2713, 7126, 3401, 963, 6596, 607, 5027,
  7078, 4484, 5937, 944, 2860, 2680, 5049, 1777, 5850, 3387, 6487, 6777, 4812, 4724, 7077, 186,
  6848, 6793, 3463, 5877, 1174, 7116, 3077, 5945, 6591, 590, 6643, 1337, 6036, 3991, 1675, 2053,
  6055, 1162, 1679, 3883, 4311, 2106, 6163, 4486, 6374, 5006, 4576, 4288, 5180, 4102, 282, 6119,
  7443, 6330, 3184, 4971, 2530, 5325, 4171, 7185, 5175, 5655, 1898, 382, 7211, 43, 5965, 6073,
  1730, 332, 1577, 3304, 2329, 1699, 6150, 2379, 5113, 333, 3502, 4517, 1480, 1172, 5567, 651,
  925, 4573, 599, 1367, 4109, 1863, 6929, 1605, 3866, 2065, 4048, 839, 5764, 2447, 2022, 3345,
  1990, 4067, 2036, 2069, 3567, 7371, 2368, 339, 6947, 2159, 654, 7327, 2768, 6676, 987, 2214};

const uint16_t zetas_full_bitrev_montgomery[2*KYBER_N] = {
990, 6691, 7427, 254, 2634, 5047, 6819, 862, 578, 7103, 3281, 4400, 2143, 5538, 1095, 6586, 484, 7197, 6362, 1319, 3336, 4345, 5382, 2299, 6086, 1595, 3823, 3858, 877, 6804, 5656, 2025, 3583, 4098, 7010, 671, 6414, 1267, 263, 7418, 1285, 6396, 291, 7390, 7143, 538, 7338, 343, 1581, 6100, 5134, 2547, 5184, 2497, 5932, 1749, 4042, 3639, 5775, 1906, 2468, 5213, 3, 7678, 606, 7075, 729, 6952, 5383, 2298, 962, 6719, 3240, 4441, 7548, 133, 5129, 2552, 7653, 28, 5929, 1752, 4965, 2716, 2461, 5220, 641, 7040, 1584, 6097, 2666, 5015, 1142, 6539, 157, 7524, 7407, 274, 5222, 2459, 5602, 2079, 5142, 2539, 6140, 1541, 5485, 2196, 4931, 2750, 1559, 6122, 2085, 5596, 5284, 2397, 2056, 5625, 3538, 4143, 7269, 412, 3535, 4146, 7190, 491, 1957, 5724, 3465, 4216, 6792, 889, 1538, 6143, 4664, 3017, 2023, 5658, 7643, 38, 3660, 4021, 7673, 8, 1694, 5987, 6905, 776, 3995, 3686, 3475, 4206, 5939, 1742, 1859, 5822, 6910, 771, 4434, 3247, 1019, 6662, 1492, 6189, 7087, 594, 4761, 2920, 657, 7024, 4859, 2822, 5798, 1883, 2640, 5041, 1693, 5988, 2607, 5074, 2782, 4899, 5400, 2281, 6466, 1215, 1010, 6671, 957, 6724, 3851, 3830, 2121, 5560, 6392, 1289, 7319, 362, 3367, 4314, 3659, 4022, 3375, 4306, 6430, 1251, 7583, 98, 1549, 6132, 5856, 1825, 4773, 2908, 6084, 1597, 5544, 2137, 1650, 6031, 3997, 3684, 4390, 3291, 6722, 959, 2915, 4766, 4245, 3436, 2635, 5046, 6128, 1553, 7676, 5, 5737, 1944, 1616, 6065, 3457, 4224, 3132, 4549, 7196, 485, 4702, 2979, 6239, 1442, 851, 6830, 2122, 5559, 3009, 4672, 7613, 68, 7295, 386, 2007, 5674, 323, 7358, 5112, 2569, 3716, 3965, 2289, 5392, 6442, 1239, 6965, 716, 2713, 4968, 7126, 555, 3401, 4280, 963, 6718, 6596, 1085, 607, 7074, 5027, 2654, 7078, 603, 4484, 3197, 5937, 1744, 944, 6737, 2860, 4821, 2680, 5001, 5049, 2632, 1777, 5904, 5850, 1831, 3387, 4294, 6487, 1194, 6777, 904, 4812, 2869, 4724, 2957, 7077, 604, 186, 7495, 6848, 833, 6793, 888, 3463, 4218, 5877, 1804, 1174, 6507, 7116, 565, 3077, 4604, 5945, 1736, 6591, 1090, 590, 7091, 6643, 1038, 1337, 6344, 6036, 1645, 3991, 3690, 1675, 6006, 2053, 5628, 6055, 1626, 1162, 6519, 1679, 6002, 3883, 3798, 4311, 3370, 2106, 5575, 6163, 1518, 4486, 3195, 6374, 1307, 5006, 2675, 4576, 3105, 4288, 3393, 5180, 2501, 4102, 3579, 282, 7399, 6119, 1562, 7443, 238, 6330, 1351, 3184, 4497, 4971, 2710, 2530, 5151, 5325, 2356, 4171, 3510, 7185, 496, 5175, 2506, 5655, 2026, 1898, 5783, 382, 7299, 7211, 470, 43, 7638, 5965, 1716, 6073, 1608, 1730, 5951, 332, 7349, 1577, 6104, 3304, 4377, 2329, 5352, 1699, 5982, 6150, 1531, 2379, 5302, 5113, 2568, 333, 7348, 3502, 4179, 4517, 3164, 1480, 6201, 1172, 6509, 5567, 2114, 651, 7030, 925, 6756, 4573, 3108, 599, 7082, 1367, 6314, 4109, 3572, 1863, 5818, 6929, 752, 1605, 6076, 3866, 3815, 2065, 5616, 4048, 3633, 839, 6842, 5764, 1917, 2447, 5234, 2022, 5659, 3345, 4336, 1990, 5691, 4067, 3614, 2036, 5645, 2069, 5612, 3567, 4114, 7371, 310, 2368, 5313, 339, 7342, 6947, 734, 2159, 5522, 654, 7027, 7327, 354, 2768, 4913, 6676, 1005, 987, 6694, 2214, 5467};

const uint16_t zetas_full_normal_order_montgomery[2*KYBER_N] = {
990, 7613, 3465, 7443, 606, 6848, 2121, 925, 3583, 7078, 1019, 1730, 7407, 6055, 6722, 1990, 484, 6965, 1694, 5175, 5929, 6591, 1549, 3866, 1581, 5850, 1693, 5113, 2085, 6374, 3457, 6947, 578, 5112, 2023, 2530, 3240, 1174, 3659, 4109, 1285, 2860, 657, 2329, 6140, 4311, 6128, 3567, 6086, 963, 5939, 7211, 1584, 6036, 5544, 5764, 4042, 4812, 6466, 1480, 7269, 5180, 6239, 2768, 2634, 2007, 1538, 3184, 5383, 3463, 7319, 599, 6414, 5937, 7087, 1577, 5602, 1679, 4245, 2036, 3336, 7126, 3995, 1898, 2461, 6643, 4773, 4048, 5184, 6487, 2782, 3502, 2056, 4576, 7196, 654, 2143, 2289, 3660, 4171, 5129, 3077, 6430, 6929, 7143, 5049, 5798, 6150, 4931, 6163, 5737, 2368, 877, 607, 6910, 5965, 1142, 1675, 3997, 2022, 2468, 7077, 957, 5567, 7190, 282, 2122, 987, 7427, 7295, 6792, 6330, 729, 6793, 6392, 4573, 7010, 4484, 1492, 332, 5222, 1162, 2915, 4067, 6362, 2713, 6905, 5655, 4965, 590, 5856, 2065, 5134, 3387, 2607, 333, 5284, 5006, 3132, 2159, 3281, 3716, 7643, 5325, 7548, 7116, 3375, 1863, 291, 2680, 4859, 1699, 5485, 2106, 7676, 7371, 3823, 6596, 1859, 43, 2666, 3991, 1650, 2447, 5775, 4724, 1010, 1172, 3535, 4102, 851, 6676, 6819, 323, 4664, 4971, 962, 5877, 3367, 1367, 263, 944, 4761, 3304, 5142, 3883, 2635, 2069, 5382, 3401, 3475, 382, 641, 1337, 6084, 839, 5932, 6777, 5400, 4517, 3538, 4288, 4702, 7327, 1095, 6442, 7673, 7185, 7653, 5945, 7583, 1605, 7338, 1777, 2640, 2379, 1559, 4486, 1616, 339, 5656, 5027, 4434, 6073, 157, 2053, 4390, 3345, 3, 186, 3851, 651, 1957, 6119, 3009, 2214, 6691, 68, 4216, 238, 7075, 833, 5560, 6756, 4098, 603, 6662, 5951, 274, 1626, 959, 5691, 7197, 716, 5987, 2506, 1752, 1090, 6132, 3815, 6100, 1831, 5988, 2568, 5596, 1307, 4224, 734, 7103, 2569, 5658, 5151, 4441, 6507, 4022, 3572, 6396, 4821, 7024, 5352, 1541, 3370, 1553, 4114, 1595, 6718, 1742, 470, 6097, 1645, 2137, 1917, 3639, 2869, 1215, 6201, 412, 2501, 1442, 4913, 5047, 5674, 6143, 4497, 2298, 4218, 362, 7082, 1267, 1744, 594, 6104, 2079, 6002, 3436, 5645, 4345, 555, 3686, 5783, 5220, 1038, 2908, 3633, 2497, 1194, 4899, 4179, 5625, 3105, 485, 7027, 5538, 5392, 4021, 3510, 2552, 4604, 1251, 752, 538, 2632, 1883, 1531, 2750, 1518, 1944, 5313, 6804, 7074, 771, 1716, 6539, 6006, 3684, 5659, 5213, 604, 6724, 2114, 491, 7399, 5559, 6694, 254, 386, 889, 1351, 6952, 888, 1289, 3108, 671, 3197, 6189, 7349, 2459, 6519, 4766, 3614, 1319, 4968, 776, 2026, 2716, 7091, 1825, 5616, 2547, 4294, 5074, 7348, 2397, 2675, 4549, 5522, 4400, 3965, 38, 2356, 133, 565, 4306, 5818, 7390, 5001, 2822, 5982, 2196, 5575, 5, 310, 3858, 1085, 5822, 7638, 5015, 3690, 6031, 5234, 1906, 2957, 6671, 6509, 4146, 3579, 6830, 1005, 862, 7358, 3017, 2710, 6719, 1804, 4314, 6314, 7418, 6737, 2920, 4377, 2539, 3798, 5046, 5612, 2299, 4280, 4206, 7299, 7040, 6344, 1597, 6842, 1749, 904, 2281, 3164, 4143, 3393, 2979, 354, 6586, 1239, 8, 496, 28, 1736, 98, 6076, 343, 5904, 5041, 5302, 6122, 3195, 6065, 7342, 2025, 2654, 3247, 1608, 7524, 5628, 3291, 4336, 7678, 7495, 3830, 7030, 5724, 1562, 4672, 5467};

const uint16_t omegas_inv_full_normal_order_montgomery[KYBER_N] = {
990, 4672, 5724, 3830, 7678, 3291, 7524, 3247, 2025, 6065, 6122, 5041, 343, 98, 28, 8, 6586, 2979, 4143, 2281, 1749, 1597, 7040, 4206, 2299, 5046, 2539, 2920, 7418, 4314, 6719, 3017, 862, 6830, 4146, 6671, 1906, 6031, 5015, 5822, 3858, 5, 2196, 2822, 7390, 4306, 133, 38, 4400, 4549, 2397, 5074, 2547, 1825, 2716, 776, 1319, 4766, 2459, 6189, 671, 1289, 6952, 889, 254, 5559, 491, 6724, 5213, 3684, 6539, 771, 6804, 1944, 2750, 1883, 538, 1251, 2552, 4021, 5538, 485, 5625, 4899, 2497, 2908, 5220, 3686, 4345, 3436, 2079, 594, 1267, 362, 2298, 6143, 5047, 1442, 412, 1215, 3639, 2137, 6097, 1742, 1595, 1553, 1541, 7024, 6396, 4022, 4441, 5658, 7103, 4224, 5596, 5988, 6100, 6132, 1752, 5987, 7197, 959, 274, 6662, 4098, 5560, 7075, 4216, 6691, 3009, 1957, 3851, 3, 4390, 157, 4434, 5656, 1616, 1559, 2640, 7338, 7583, 7653, 7673, 1095, 4702, 3538, 5400, 5932, 6084, 641, 3475, 5382, 2635, 5142, 4761, 263, 3367, 962, 4664, 6819, 851, 3535, 1010, 5775, 1650, 2666, 1859, 3823, 7676, 5485, 4859, 291, 3375, 7548, 7643, 3281, 3132, 5284, 2607, 5134, 5856, 4965, 6905, 6362, 2915, 5222, 1492, 7010, 6392, 729, 6792, 7427, 2122, 7190, 957, 2468, 3997, 1142, 6910, 877, 5737, 4931, 5798, 7143, 6430, 5129, 3660, 2143, 7196, 2056, 2782, 5184, 4773, 2461, 3995, 3336, 4245, 5602, 7087, 6414, 7319, 5383, 1538, 2634, 6239, 7269, 6466, 4042, 5544, 1584, 5939, 6086, 6128, 6140, 657, 1285, 3659, 3240, 2023, 578, 3457, 2085, 1693, 1581, 1549, 5929, 1694, 484, 6722, 7407, 1019, 3583, 2121, 606, 3465};

const uint16_t omegas_inv_full_bitrev_montgomery[KYBER_N] = {
990, 6691, 254, 7427, 862, 6819, 5047, 2634, 6586, 1095, 5538, 2143, 4400, 3281, 7103, 578, 2025, 5656, 6804, 877, 3858, 3823, 1595, 6086, 2299, 5382, 4345, 3336, 1319, 6362, 7197, 484, 7678, 3, 5213, 2468, 1906, 5775, 3639, 4042, 1749, 5932, 2497, 5184, 2547, 5134, 6100, 1581, 343, 7338, 538, 7143, 7390, 291, 6396, 1285, 7418, 263, 1267, 6414, 671, 7010, 4098, 3583, 5724, 1957, 491, 7190, 4146, 3535, 412, 7269, 4143, 3538, 5625, 2056, 2397, 5284, 5596, 2085, 6122, 1559, 2750, 4931, 2196, 5485, 1541, 6140, 2539, 5142, 2079, 5602, 2459, 5222, 274, 7407, 7524, 157, 6539, 1142, 5015, 2666, 6097, 1584, 7040, 641, 5220, 2461, 2716, 4965, 1752, 5929, 28, 7653, 2552, 5129, 133, 7548, 4441, 3240, 6719, 962, 2298, 5383, 6952, 729, 7075, 606, 4672, 3009, 5559, 2122, 6830, 851, 1442, 6239, 2979, 4702, 485, 7196, 4549, 3132, 4224, 3457, 6065, 1616, 1944, 5737, 5, 7676, 1553, 6128, 5046, 2635, 3436, 4245, 4766, 2915, 959, 6722, 3291, 4390, 3684, 3997, 6031, 1650, 2137, 5544, 1597, 6084, 2908, 4773, 1825, 5856, 6132, 1549, 98, 7583, 1251, 6430, 4306, 3375, 4022, 3659, 4314, 3367, 362, 7319, 1289, 6392, 5560, 2121, 3830, 3851, 6724, 957, 6671, 1010, 1215, 6466, 2281, 5400, 4899, 2782, 5074, 2607, 5988, 1693, 5041, 2640, 1883, 5798, 2822, 4859, 7024, 657, 2920, 4761, 594, 7087, 6189, 1492, 6662, 1019, 3247, 4434, 771, 6910, 5822, 1859, 1742, 5939, 4206, 3475, 3686, 3995, 776, 6905, 5987, 1694, 8, 7673, 4021, 3660, 38, 7643, 5658, 2023, 3017, 4664, 6143, 1538, 889, 6792, 4216, 3465};

const uint16_t omegas_inv_bitrev_montgomery[KYBER_N/2] = {
  990, 254, 862, 5047, 6586, 5538, 4400, 7103, 2025, 6804, 3858, 1595, 2299, 4345, 1319, 7197,
  7678, 5213, 1906, 3639, 1749, 2497, 2547, 6100, 343, 538, 7390, 6396, 7418, 1267, 671, 4098,
  5724, 491, 4146, 412, 4143, 5625, 2397, 5596, 6122, 2750, 2196, 1541, 2539, 2079, 2459, 274,
  7524, 6539, 5015, 6097, 7040, 5220, 2716, 1752, 28, 2552, 133, 4441, 6719, 2298, 6952, 7075,
  4672, 5559, 6830, 1442, 2979, 485, 4549, 4224, 6065, 1944, 5, 1553, 5046, 3436, 4766, 959,
  3291, 3684, 6031, 2137, 1597, 2908, 1825, 6132, 98, 1251, 4306, 4022, 4314, 362, 1289, 5560,
  3830, 6724, 6671, 1215, 2281, 4899, 5074, 5988, 5041, 1883, 2822, 7024, 2920, 594, 6189, 6662,
  3247, 771, 5822, 1742, 4206, 3686, 776, 5987, 8, 4021, 38, 5658, 3017, 6143, 889, 4216};

  const uint16_t inv_psis_montgomery_normal_order[2*KYBER_N] = {
  990, 5467, 4672, 1562, 5724, 7030, 3830, 7495, 7678, 4336, 3291, 5628, 7524, 1608, 3247, 2654, 2025, 7342, 6065, 3195, 6122, 5302, 5041, 5904, 343, 6076, 98, 1736, 28, 496, 8, 1239, 6586, 354, 2979, 3393, 4143, 3164, 2281, 904, 1749, 6842, 1597, 6344, 7040, 7299, 4206, 4280, 2299, 5612, 5046, 3798, 2539, 4377, 2920, 6737, 7418, 6314, 4314, 1804, 6719, 2710, 3017, 7358, 862, 1005, 6830, 3579, 4146, 6509, 6671, 2957, 1906, 5234, 6031, 3690, 5015, 7638, 5822, 1085, 3858, 310, 5, 5575, 2196, 5982, 2822, 5001, 7390, 5818, 4306, 565, 133, 2356, 38, 3965, 4400, 5522, 4549, 2675, 2397, 7348, 5074, 4294, 2547, 5616, 1825, 7091, 2716, 2026, 776, 4968, 1319, 3614, 4766, 6519, 2459, 7349, 6189, 3197, 671, 3108, 1289, 888, 6952, 1351, 889, 386, 254, 6694, 5559, 7399, 491, 2114, 6724, 604, 5213, 5659, 3684, 6006, 6539, 1716, 771, 7074, 6804, 5313, 1944, 1518, 2750, 1531, 1883, 2632, 538, 752, 1251, 4604, 2552, 3510, 4021, 5392, 5538, 7027, 485, 3105, 5625, 4179, 4899, 1194, 2497, 3633, 2908, 1038, 5220, 5783, 3686, 555, 4345, 5645, 3436, 6002, 2079, 6104, 594, 1744, 1267, 7082, 362, 4218, 2298, 4497, 6143, 5674, 5047, 4913, 1442, 2501, 412, 6201, 1215, 2869, 3639, 1917, 2137, 1645, 6097, 470, 1742, 6718, 1595, 4114, 1553, 3370, 1541, 5352, 7024, 4821, 6396, 3572, 4022, 6507, 4441, 5151, 5658, 2569, 7103, 734, 4224, 1307, 5596, 2568, 5988, 1831, 6100, 3815, 6132, 1090, 1752, 2506, 5987, 716, 7197, 5691, 959, 1626, 274, 5951, 6662, 603, 4098, 6756, 5560, 833, 7075, 238, 4216, 68, 6691, 2214, 3009, 6119, 1957, 651, 3851, 186, 3, 3345, 4390, 2053, 157, 6073, 4434, 5027, 5656, 339, 1616, 4486, 1559, 2379, 2640, 1777, 7338, 1605, 7583, 5945, 7653, 7185, 7673, 6442, 1095, 7327, 4702, 4288, 3538, 4517, 5400, 6777, 5932, 839, 6084, 1337, 641, 382, 3475, 3401, 5382, 2069, 2635, 3883, 5142, 3304, 4761, 944, 263, 1367, 3367, 5877, 962, 4971, 4664, 323, 6819, 6676, 851, 4102, 3535, 1172, 1010, 4724, 5775, 2447, 1650, 3991, 2666, 43, 1859, 6596, 3823, 7371, 7676, 2106, 5485, 1699, 4859, 2680, 291, 1863, 3375, 7116, 7548, 5325, 7643, 3716, 3281, 2159, 3132, 5006, 5284, 333, 2607, 3387, 5134, 2065, 5856, 590, 4965, 5655, 6905, 2713, 6362, 4067, 2915, 1162, 5222, 332, 1492, 4484, 7010, 4573, 6392, 6793, 729, 6330, 6792, 7295, 7427, 987, 2122, 282, 7190, 5567, 957, 7077, 2468, 2022, 3997, 1675, 1142, 5965, 6910, 607, 877, 2368, 5737, 6163, 4931, 6150, 5798, 5049, 7143, 6929, 6430, 3077, 5129, 4171, 3660, 2289, 2143, 654, 7196, 4576, 2056, 3502, 2782, 6487, 5184, 4048, 4773, 6643, 2461, 1898, 3995, 7126, 3336, 2036, 4245, 1679, 5602, 1577, 7087, 5937, 6414, 599, 7319, 3463, 5383, 3184, 1538, 2007, 2634, 2768, 6239, 5180, 7269, 1480, 6466, 4812, 4042, 5764, 5544, 6036, 1584, 7211, 5939, 963, 6086, 3567, 6128, 4311, 6140, 2329, 657, 2860, 1285, 4109, 3659, 1174, 3240, 2530, 2023, 5112, 578, 6947, 3457, 6374, 2085, 5113, 1693, 5850, 1581, 3866, 1549, 6591, 5929, 5175, 1694, 6965, 484, 1990, 6722, 6055, 7407, 1730, 1019, 7078, 3583, 925, 2121, 6848, 606, 7443, 3465, 7613};

const uint16_t psis_inv_montgomery[KYBER_N] = {
  1024, 4972, 5779, 6907, 4943, 4168,  315, 5580,   90,  497, 1123,  142, 4710, 5527, 2443, 4871,
   698, 2489, 2394, 4003,  684, 2241, 2390, 7224, 5072, 2064, 4741, 1687, 6841,  482, 7441, 1235,
  2126, 4742, 2802, 5744, 6287, 4933,  699, 3604, 1297, 2127, 5857, 1705, 3868, 3779, 4397, 2177,
   159,  622, 2240, 1275,  640, 6948, 4572, 5277,  209, 2605, 1157, 7328, 5817, 3191, 1662, 2009,
  4864,  574, 2487,  164, 6197, 4436, 7257, 3462, 4268, 4281, 3414, 4515, 3170, 1290, 2003, 5855,
  7156, 6062, 7531, 1732, 3249, 4884, 7512, 3590, 1049, 2123, 1397, 6093, 3691, 6130, 6541, 3946,
  6258, 3322, 1788, 4241, 4900, 2309, 1400, 1757,  400,  502, 6698, 2338, 3011,  668, 7444, 4580,
  6516, 6795, 2959, 4136, 3040, 2279, 6355, 3943, 2913, 6613, 7416, 4084, 6508, 5556, 4054, 3782,
    61, 6567, 2212,  779,  632, 5709, 5667, 4923, 4911, 6893, 4695, 4164, 3536, 2287, 7594, 2848,
  3267, 1911, 3128,  546, 1991,  156, 4958, 5531, 6903,  483,  875,  138,  250, 2234, 2266, 7222,
  2842, 4258,  812, 6703,  232, 5207, 6650, 2585, 1900, 6225, 4932, 7265, 4701, 3173, 4635, 6393,
   227, 7313, 4454, 4284, 6759, 1224, 5223, 1447,  395, 2608, 4502, 4037,  189, 3348,   54, 6443,
  2210, 6230, 2826, 1780, 3002, 5995, 1955, 6102, 6045, 3938, 5019, 4417, 1434, 1262, 1507, 5847,
  5917, 7157, 7177, 6434, 7537,  741, 4348, 1309,  145,  374, 2236, 4496, 5028, 6771, 6923, 7421,
  1978, 1023, 3857, 6876, 1102, 7451, 4704, 6518, 1344,  765,  384, 5705, 1207, 1630, 4734, 1563,
  6839, 5933, 1954, 4987, 7142, 5814, 7527, 4953, 7637, 4707, 2182, 5734, 2818,  541, 4097, 5641};

const uint16_t psis_inv_montgomery_full[2*KYBER_N] = {
1024, 4972, 5779, 6907, 4943, 4168, 315, 5580, 90, 497, 1123, 142, 4710, 5527, 2443, 4871, 698, 2489, 2394, 4003, 684, 2241, 2390, 7224, 5072, 2064, 4741, 1687, 6841, 482, 7441, 1235, 2126, 4742, 2802, 5744, 6287, 4933, 699, 3604, 1297, 2127, 5857, 1705, 3868, 3779, 4397, 2177, 159, 622, 2240, 1275, 640, 6948, 4572, 5277, 209, 2605, 1157, 7328, 5817, 3191, 1662, 2009, 4864, 574, 2487, 164, 6197, 4436, 7257, 3462, 4268, 4281, 3414, 4515, 3170, 1290, 2003, 5855, 7156, 6062, 7531, 1732, 3249, 4884, 7512, 3590, 1049, 2123, 1397, 6093, 3691, 6130, 6541, 3946, 6258, 3322, 1788, 4241, 4900, 2309, 1400, 1757, 400, 502, 6698, 2338, 3011, 668, 7444, 4580, 6516, 6795, 2959, 4136, 3040, 2279, 6355, 3943, 2913, 6613, 7416, 4084, 6508, 5556, 4054, 3782, 61, 6567, 2212, 779, 632, 5709, 5667, 4923, 4911, 6893, 4695, 4164, 3536, 2287, 7594, 2848, 3267, 1911, 3128, 546, 1991, 156, 4958, 5531, 6903, 483, 875, 138, 250, 2234, 2266, 7222, 2842, 4258, 812, 6703, 232, 5207, 6650, 2585, 1900, 6225, 4932, 7265, 4701, 3173, 4635, 6393, 227, 7313, 4454, 4284, 6759, 1224, 5223, 1447, 395, 2608, 4502, 4037, 189, 3348, 54, 6443, 2210, 6230, 2826, 1780, 3002, 5995, 1955, 6102, 6045, 3938, 5019, 4417, 1434, 1262, 1507, 5847, 5917, 7157, 7177, 6434, 7537, 741, 4348, 1309, 145, 374, 2236, 4496, 5028, 6771, 6923, 7421, 1978, 1023, 3857, 6876, 1102, 7451, 4704, 6518, 1344, 765, 384, 5705, 1207, 1630, 4734, 1563, 6839, 5933, 1954, 4987, 7142, 5814, 7527, 4953, 7637, 4707, 2182, 5734, 2818, 541, 4097, 5641, 6657, 2709, 1902, 774, 2738, 3513, 7366, 2101, 7591, 7184, 6558, 7539, 2971, 2154, 5238, 2810, 6983, 5192, 5287, 3678, 6997, 5440, 5291, 457, 2609, 5617, 2940, 5994, 840, 7199, 240, 6446, 5555, 2939, 4879, 1937, 1394, 2748, 6982, 4077, 6384, 5554, 1824, 5976, 3813, 3902, 3284, 5504, 7522, 7059, 5441, 6406, 7041, 733, 3109, 2404, 7472, 5076, 6524, 353, 1864, 4490, 6019, 5672, 2817, 7107, 5194, 7517, 1484, 3245, 424, 4219, 3413, 3400, 4267, 3166, 4511, 6391, 5678, 1826, 525, 1619, 150, 5949, 4432, 2797, 169, 4091, 6632, 5558, 6284, 1588, 3990, 1551, 1140, 3735, 1423, 4359, 5893, 3440, 2781, 5372, 6281, 5924, 7281, 7179, 983, 5343, 4670, 7013, 237, 3101, 1165, 886, 4722, 3545, 4641, 5402, 1326, 3738, 4768, 1068, 265, 3597, 1173, 2125, 3627, 3899, 7620, 1114, 5469, 6902, 7049, 1972, 2014, 2758, 2770, 788, 2986, 3517, 4145, 5394, 87, 4833, 4414, 5770, 4553, 7135, 5690, 7525, 2723, 2150, 778, 7198, 6806, 7543, 7431, 5447, 5415, 459, 4839, 3423, 6869, 978, 7449, 2474, 1031, 5096, 5781, 1456, 2749, 416, 2980, 4508, 3046, 1288, 7454, 368, 3227, 3397, 922, 6457, 2458, 6234, 7286, 5073, 3179, 3644, 7492, 4333, 7627, 1238, 5471, 1451, 4855, 5901, 4679, 1686, 5726, 1579, 1636, 3743, 2662, 3264, 6247, 6419, 6174, 1834, 1764, 524, 504, 1247, 144, 6940, 3333, 6372, 7536, 7307, 5445, 3185, 2653, 910, 758, 260, 5703, 6658, 3824, 805, 6579, 230, 2977, 1163, 6337, 6916, 7297, 1976, 6474, 6051, 2947, 6118, 842, 1748, 5727, 2694, 539, 1867, 154, 2728, 44, 2974, 5499, 1947, 4863, 7140, 3584, 2040};
